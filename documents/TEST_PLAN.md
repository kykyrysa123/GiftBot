# План тестирования Telegram бота для заказов

## Информация о документе
**Проект**: Telegram бот для оформления заказов  
**Версия**: 1.0  
**Статус**: Утвержден  

## Содержание
1. [Введение](#введение)
2. [Цели тестирования](#цели-тестирования)
3. [Область тестирования](#область-тестирования)
4. [Стратегия тестирования](#стратегия-тестирования)
5. [Типы тестирования](#типы-тестирования)
6. [Тестовое окружение](#тестовое-окружение)
7. [Тестовые данные](#тестовые-данные)
8. [График тестирования](#график-тестирования)
9. [Результаты тестирования](#результаты-тестирования)
10. [Оценка рисков](#оценка-рисков)
11. [Инструменты тестирования](#инструменты-тестирования)

## 1. Введение

### 1.1 Цель
Этот документ описывает стратегию тестирования Telegram бота для оформления заказов, обеспечивающую полную проверку функциональных и нефункциональных требований.

### 1.2 Область применения
План тестирования охватывает всю систему Telegram бота:

- Бэкенд Java Spring Boot приложение
- Интеграция с Telegram Bot API
- База данных SQLite (orders.db)
- Управление состояниями пользователей
- Генерация Excel отчетов
- Система уведомлений

### 1.3 Ссылки
- Software Requirements Specification (SRS.md)
- Документация доменной модели
- Диаграммы архитектуры компонентов

## 2. Цели тестирования

### 2.1 Основные цели
- Проверить корректность реализации функциональных требований
- Обеспечить соответствие нефункциональным требованиям (производительность, безопасность)
- Валидировать интеграцию между компонентами системы
- Подтвердить целостность данных при параллельных операциях
- Протестировать пользовательский опыт в Telegram

### 2.2 Критерии успеха
- Весь критический функционал оформления заказов работает корректно
- Требования к производительности выполнены (< 5 сек на генерацию Excel)
- Выявлены и устранены уязвимости безопасности
- Интерфейс бота интуитивно понятен
- Отсутствует потеря данных при перезапусках

## 3. Область тестирования

### 3.1 В области тестирования
**Управление пользователями**:
- Состояния пользователей (user states)
- Сессии оформления заказов

**Оформление заказов**:
- Прием текста, ссылок, скриншотов
- Валидация входных данных
- Последовательность шагов оформления

**Управление заказами**:
- Сохранение заказов в БД
- Статусы заказов (новый/одобренный)
- История заказов пользователя

**Функции администратора**:
- Просмотр всех заказов (/orders)
- Одобрение заказов (/approve)
- Очистка базы данных (/clearorders)

**Интеграция с Telegram**:
- Обработка сообщений и команд
- Работа с файлами (скриншоты)
- Клавиатуры и кнопки

**База данных**:
- Операции CRUD
- Целостность данных
- Транзакции

### 3.2 Вне области тестирования
- Интеграция с платежными системами
- Система email-уведомлений
- Мобильное приложение
- Многоязычная поддержка
- Продвинутая аналитика

## 4. Стратегия тестирования

### 4.1 Подход к тестированию
**Тестирование на основе рисков**: Фокус на критическом функционале оформления заказов  
**Интеграционное тестирование**: Проверка взаимодействия между компонентами  
**Системное тестирование**: Валидация полного workflow оформления заказа  
**Тестирование целостности данных**: Проверка согласованности данных при параллельных операциях  

### 4.2 Уровни тестирования
**Модульное тестирование**: Отдельные сервисы и контроллеры  
**Интеграционное тестирование**: API endpoints и взаимодействие с БД  
**Системное тестирование**: Полный workflow оформления заказа  
**Приемочное тестирование**: Пользовательские сценарии и бизнес-требования  

## 5. Типы тестирования

### 5.1 Функциональное тестирование

#### 5.1.1 Команды и навигация
**Команда /start**
- Отображение приветственного сообщения
- Показ главного меню
- Кнопки навигации

**Главное меню**
- Доступность всех опций
- Корректная навигация между состояниями

#### 5.1.2 Оформление заказов
**Процесс оформления**
- Последовательность шагов: username → ФИО → телефон → адрес
- Кнопки "Далее" и "Отмена"
- Сохранение промежуточных данных

**Валидация данных**
- Формат телефона (+375...)
- Username с символом @
- ФИО из трех слов
- Валидация ссылок

**Работа с файлами**
- Загрузка скриншотов
- Обработка нескольких файлов
- Сохранение file_id в БД

#### 5.1.3 Функции администратора
**Команда /orders**
- Генерация Excel файла
- Форматирование данных
- Гиперссылки на фото

**Одобрение заказов**
- Команда /approve <id>
- Изменение статуса заказа
- Уведомление пользователя

**Управление базой**
- Очистка заказов (/clearorders)
- Целостность данных после операций

#### 5.1.4 Управление состояниями
**Сессии пользователей**
- ConcurrentHashMap состояний
- Обработка параллельных запросов
- Восстановление после перезапуска

### 5.2 Нефункциональное тестирование

#### 5.2.1 Тестирование производительности
**Время ответа**:
- Обработка команд: < 1 секунда
- Генерация Excel: < 5 секунд для 100+ заказов

**Обработка нагрузки**:
- Параллельные заказы от multiple пользователей
- Одновременная генерация отчетов

**Оптимизация запросов**:
- Эффективные запросы к SQLite
- Кэширование данных

#### 5.2.2 Тестирование безопасности
**Аутентификация**:
- Проверка прав администратора
- Валидация доступа к командам

**Валидация входных данных**:
- Защита от SQL инъекций
- Проверка форматов данных
- Санитизация пользовательского ввода

**Защита данных**:
- Безопасное хранение пользовательских данных
- Конфиденциальность заказов

#### 5.2.3 Тестирование удобства использования
**Пользовательский интерфейс**:
- Понятные сообщения и инструкции
- Интуитивная навигация
- Кнопки вместо текстовых команд

**Пользовательский опыт**:
- Процесс оформления заказа
- Понятные сообщения об ошибках
- Обратная связь о статусе операций

#### 5.2.4 Тестирование совместимости
**Версии Java**:
- Java 17 и выше
- Совместимость с разными JVM

**Операционные системы**:
- Windows 10/11
- Linux (Ubuntu/CentOS)
- macOS

**Версии Spring Boot**:
- Spring Boot 3.x

### 5.3 Интеграционное тестирование
**Интеграция с Telegram API**:
- Обработка входящих сообщений
- Отправка ответов и файлов
- Работа с клавиатурами

**Интеграция с базой данных**:
- Операции CRUD с заказами
- Сохранение и извлечение фото
- Транзакционная целостность

**Интеграция сервисов**:
- Взаимодействие OrderService и UserStateManager
- Координация AdminService и NotificationService

### 5.4 Тестирование целостности данных
**Согласованность заказов**:
- Корректное сохранение всех данных заказа
- Связь заказов с пользователями
- Целостность ссылок на фото

**Отношения данных**:
- Связь пользователь-заказ
- Связь заказ-фотографии
- Статус заказов

## 6. Тестовое окружение

### 6.1 Аппаратные требования
**Машина для разработки/тестирования**:
- CPU: Многоядерный процессор
- RAM: 8GB минимум
- Хранилище: 10GB свободного места
- Сеть: Стабильное интернет-соединение

### 6.2 Программные требования
**Бэкенд**:
- Java 17+
- Spring Boot 3.x
- SQLite 3.x
- Maven 3.8+

**Telegram**:
- Тестовый аккаунт пользователя
- Тестовый аккаунт администратора
- Доступ к Bot API

**Инструменты тестирования**:
- JUnit 5
- Mockito
- Spring Boot Test
- SQLite JDBC

### 6.3 Настройка тестового окружения
**База данных**: Чистая тестовая БД с начальными данными  
**Приложение**: Локальный инстанс Spring Boot приложения  
**Тестовые данные**: Предварительно настроенные пользователи и заказы  

## 7. Тестовые данные

### 7.1 Тестовые пользователи
- Несколько тестовых пользователей
- Пользователь с ролью администратора
- Пользователи с разными данными (крайние случаи)

### 7.2 Тестовые заказы
- Заказы с текстом
- Заказы со ссылками
- Заказы со скриншотами
- Заказы с комбинированными данными

### 7.3 Тестовые сценарии
**Сценарии оформления заказов**:
- Корректные данные на всех шагах
- Некорректные данные (валидация)
- Прерванные заказы
- Параллельные заказы

**Сценарии администрирования**:
- Просмотр пустого списка заказов
- Просмотр большого количества заказов
- Одобрение существующих и несуществующих заказов

## 8. График тестирования

### 8.1 Фазы тестирования
**Модульное тестирование**: Неделя 1  
**Интеграционное тестирование**: Неделя 2  
**Системное тестирование**: Неделя 3  
**Приемочное тестирование**: Неделя 4  
**Исправление ошибок и повторное тестирование**: Неделя 5  

### 8.2 Временная шкала выполнения тестов
**Ежедневно**: Модульные и интеграционные тесты  
**Еженедельно**: Полный регрессионный набор тестов  
**Завершение функционала**: End-to-end системное тестирование  
**Перед выпуском**: Финальная валидация  

## 9. Результаты тестирования

### 9.1 Тестовая документация
- План тестирования (этот документ)
- Детальные тест-кейсы
- Отчет о результатах тестирования
- Отчеты о дефектах
- Сводный отчет о тестировании
- Отчет о завершении тестирования

### 9.2 Тестовые артефакты
- Автоматизированные тестовые скрипты
- Наборы тестовых данных
- Конфигурация тестового окружения
- Результаты нагрузочного тестирования
- Результаты тестирования безопасности

## 10. Оценка рисков

### 10.1 Выявленные риски
**Высокий риск**
- Потеря данных при перезапуске бота во время оформления заказа
- Гонки при параллельной отправке фото
- Проблемы с производительностью при большом количестве заказов

**Средний риск**
- Некорректная валидация входных данных
- Проблемы с генерацией Excel файлов
- Потеря состояний пользователей

**Низкий риск**
- Косметические проблемы в сообщениях
- Второстепенные функции работают неидеально

### 10.2 Стратегии снижения рисков
**Для высоких рисков**:
- Реализация механизма восстановления сессий
- Синхронизация при работе с файлами
- Оптимизация запросов к базе данных

**Для средних рисков**:
- Усиление валидации входных данных
- Тщательное тестирование генерации отчетов
- Мониторинг состояний пользователей

**Для низких рисков**:
- Регулярный рефакторинг кода
- Постепенное улучшение второстепенных функций

## 11. Инструменты тестирования

### 11.1 Тестирование бэкенда
**JUnit 5**: Фреймворк для модульного тестирования  
**Mockito**: Фреймворк для мокирования зависимостей  
**Spring Boot Test**: Поддержка интеграционного тестирования  
**SQLite JDBC**: Тестирование интеграции с базой данных  

### 11.2 Тестирование Telegram API
**Telegram Bots Test**: Тестирование взаимодействия с Telegram API  
**Ручное тестирование**: Проверка реальных сценариев в Telegram  

### 11.3 Тестирование базы данных
**Модульные тесты БД**: Тестирование слоя доступа к данным  
**Интеграционные тесты**: Тестирование транзакций БД  
**Тесты миграций**: Валидация изменений схемы  

### 11.4 Тестирование производительности
**JMeter**: Нагрузочное тестирование  
**Инструменты профилирования Java**: Оптимизация производительности  
**Анализ запросов к БД**: Оптимизация производительности запросов  

### 11.5 Тестирование безопасности
**Ручное тестирование безопасности**: Тестирование аутентификации и авторизации  
**Тестирование валидации данных**: Проверка санитизации ввода  

## 12. Руководство по выполнению тестирования

### 12.1 Выполнение тест-кейсов
- Выполнять тест-кейсы в логическом порядке workflow бизнес-процессов
- Документировать все результаты тестирования со скриншотами, когда это применимо
- Немедленно сообщать о дефектах с четкими шагами воспроизведения
- Повторно тестировать все исправленные дефекты перед закрытием

### 12.2 Управление дефектами
**Классификация серьезности**:
- Критический: Блокирует основной функционал (например, создание заказа)
- Высокий: Основная функция не работает (например, команда /orders)
- Средний: Проблемы с второстепенными функциями (например, валидация ссылок)
- Низкий: Косметические или незначительные проблемы с удобством использования

**Отслеживание дефектов**: Использовать централизованную систему отслеживания дефектов  
**Проверка исправлений**: Независимая проверка исправлений  

### 12.3 Отчетность о тестировании
**Ежедневные отчеты**: Прогресс выполнения тестов и блокирующие проблемы  
**Еженедельные сводки**: Покрытие тестами и метрики качества  
**Отчеты о завершении фазы**: Комплексные результаты тестирования по фазам  
**Финальный отчет о тестировании**: Общая оценка качества и рекомендация по выпуску  

### 12.4 Критерии выхода
- Все критические и высокоприоритетные тест-кейсы выполнены и пройдены
- Нет открытых критических или высокоуровневых дефектов
- Все дефекты средней серьезности имеют приемлемые обходные пути или запланированные исправления
- Требования к производительности выполнены
- Обзор безопасности завершен и проблемы устранены
- Приемочное тестирование подписано

---

**Управление документацией**  
Версия: 1.0  
Следующий пересмотр: После добавления основных функций или изменений архитектуры  
